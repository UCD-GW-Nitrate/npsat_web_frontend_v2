(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12,9],{"+B3J":function(e,t,a){"use strict";a.r(t);var n=a("WmNS"),r=a.n(n),o=(a("/xke"),a("TeRw")),i=a("k1fw"),c=a("9og8"),l=a("tJVT"),s=a("q1tI"),u=a.n(s),d=a("WHYC"),m=a("9kvl"),p=a("pssB"),b=a("t3Un");function f(e,t){return h.apply(this,arguments)}function h(){return h=Object(c["a"])(r.a.mark((function e(t,a){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b["a"])("/api/model_run/".concat(t.id,"/"),{method:"GET",headers:{Authorization:"Token ".concat(a)},data:{id:t.id}}));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function E(e){return y.apply(this,arguments)}function y(){return y=Object(c["a"])(r.a.mark((function e(t){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b["a"])("/api/region/".concat(t.id,"/"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),y.apply(this,arguments)}function g(e){return v.apply(this,arguments)}function v(){return v=Object(c["a"])(r.a.mark((function e(t){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b["a"])("/api/crops/".concat(t.id,"/"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),v.apply(this,arguments)}function w(e,t){return O.apply(this,arguments)}function O(){return O=Object(c["a"])(r.a.mark((function e(t,a){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b["a"])("/api/model_results/".concat(t,"/"),{headers:{Authorization:"Token ".concat(a)},method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function j(e,t,a){return k.apply(this,arguments)}function k(){return k=Object(c["a"])(r.a.mark((function e(t,a,n){return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(b["a"])("/api/model_run/".concat(t,"/"),{headers:{Authorization:"Token ".concat(n)},method:"PUT",data:a}));case 1:case"end":return e.stop()}}),e)}))),k.apply(this,arguments)}a("Znn+");var x=a("ZTPi"),_=(a("IzEo"),a("bx4M")),T=(a("bP8k"),a("gFTJ")),I=(a("5Dmo"),a("3S7+")),S=(a("+L6B"),a("2/Rp")),L=(a("5GOC"),a("JsLm")),R=(a("FJo9"),a("L41K")),P=a("Hx5s"),M=a("TSYQ"),B=a.n(M),C=a("LtsZ"),D=Object(C["dynamic"])({loader:function(){return Object(c["a"])(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.e(5),a.e(17)]).then(a.bind(null,"hM0M"));case 2:return t=e.sent,n=t.default,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))()}}),J=Object(C["dynamic"])({loader:function(){return Object(c["a"])(r.a.mark((function e(){var t,n;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([a.e(0),a.e(5),a.e(16)]).then(a.bind(null,"B8da"));case 2:return t=e.sent,n=t.default,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e)})))()}}),N=a("+n12"),V=a("r1Ps"),q=a("fX4H"),z=a("qnQ4"),F=(a("bMVF"),a("6K1h"),function(e){var t=e.data;return u.a.createElement(V["a"],{center:[38.5816,-121.4944],zoom:6},u.a.createElement(q["a"],{key:t.length,data:t,onEachFeature:function(e,t){t.bindTooltip(e.properties.name)}}),u.a.createElement(z["a"],{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}))}),A=F,G=(a("g9YV"),a("wCAj")),H=a("oBTY"),W=function(e){return u.a.createElement(G["a"],{dataSource:Object(H["a"])(e.data),loading:e.loading,columns:[{title:"Crops",dataIndex:"name",key:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Loading percentage",dataIndex:"proportion",key:"proportion",render:function(e){return"".concat(Math.round(100*parseFloat(e)),"%")},sorter:function(e,t){return parseFloat(e.proportion)-parseFloat(t.proportion)}}],rowKey:function(e){return e.crop},pagination:!1})},Y=W,K=a("xVbb"),U=a.n(K),Q=function(e){return u.a.createElement("span",{id:e.anchor},e.title)},Z=Q,X=R["a"].Step,$=function(e){var t=e.token,a=e.userId,n=e.hash,r=e.info,o=e.publish,c=Object(s["useState"])([]),d=Object(l["a"])(c,2),p=d[0],b=d[1],f=Object(s["useState"])(0),h=Object(l["a"])(f,2),y=h[0],v=h[1],O=Object(s["useState"])([]),j=Object(l["a"])(O,2),k=j[0],M=j[1],C=Object(s["useState"])(!0),V=Object(l["a"])(C,2),q=V[0],z=V[1],F=Object(s["useState"])({}),G=Object(l["a"])(F,2),H=G[0],W=G[1],K=Object(s["useState"])([]),Q=Object(l["a"])(K,2),$=Q[0],ee=Q[1];Object(s["useEffect"])((function(){r.complete?v(3):r.running?v(2):r.ready&&v(1)}),[r]),Object(s["useEffect"])((function(){r.regions&&Promise.all(r.regions.map((function(e){return E({id:e.id})}))).then((function(e){var t=e.map((function(e){var t=e;return t.geometry.properties.name=e.name,t}));b(t)})),r.modifications&&Promise.all(r.modifications.map((function(e){return g({id:e.crop})}))).then((function(e){var t=[];e.forEach((function(e,a){var n=e.name;t.push(Object(i["a"])(Object(i["a"])({},r.modifications[a]),{},{name:n}))})),M(t),z(!1)})),r.results&&Promise.all(r.results.map((function(e){return w(e.id,t)}))).then((function(e){var t={};e.forEach((function(e){t[e.percentile]=e.values.map((function(t,a){return{year:1945+a,value:t,percentile:"".concat(Object(N["c"])(e.percentile)," percentile")}}))})),ee(e.map((function(e){return e.percentile}))),W(t)}))}),[r]),Object(s["useEffect"])((function(){if(n&&"#"===n[0]){var e=n.substr(1),t=document.getElementById(e);t&&t.scrollIntoView({behavior:"smooth"})}}),[]);var te=u.a.createElement("div",{className:B()(U.a.textSecondary,U.a.stepDescription)},r.date_submitted?new Date(r.date_submitted).toLocaleString():""),ae=r.date_completed?u.a.createElement("div",{className:B()(U.a.textSecondary,U.a.stepDescription)},new Date(r.date_completed).toLocaleString()):null;return u.a.createElement(P["b"],{subTitle:"The complete information of model.",content:u.a.createElement(L["a"],{affix:!1},u.a.createElement(L["a"].Link,{href:"#info",title:"Model info"}),u.a.createElement(L["a"].Link,{href:"#progress",title:"Model progress"}),0===$.length?null:u.a.createElement(L["a"].Link,{href:"#results",title:"Model results"}),u.a.createElement(L["a"].Link,{href:"#crop-details",title:"Crop details"}),u.a.createElement(L["a"].Link,{href:"#region-map",title:"Region map"}))},u.a.createElement("div",{className:U.a.main},u.a.createElement(_["a"],{title:u.a.createElement(Z,{title:"Model info",anchor:"info"}),bordered:!1,style:{marginBottom:32},extra:u.a.createElement(I["a"],{title:"only model creator can publish/un-publish the model"},u.a.createElement(S["a"],{type:"primary",disabled:a!==r.user,onClick:function(){o(r)}},r.public?"Un-publish the model":"publish the model"))},u.a.createElement(T["a"],{bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},u.a.createElement(T["a"].Item,{label:"Model name"},r.name),u.a.createElement(T["a"].Item,{label:"Date created"},r.date_submitted?new Date(r.date_submitted).toLocaleString():""),u.a.createElement(T["a"].Item,{label:"Date completed"},r.date_completed?new Date(r.date_completed).toLocaleString():"not yet completed"),u.a.createElement(T["a"].Item,{label:"Number of years to predict"},r.n_years),u.a.createElement(T["a"].Item,{label:"Reduction year"},r.reduction_year),u.a.createElement(T["a"].Item,{label:"Water content"},"".concat(100*r.water_content,"%")),u.a.createElement(T["a"].Item,{label:"Scenario"},r.scenario&&r.scenario.name||""),u.a.createElement(T["a"].Item,{label:"is public model"},r.public?"yes":"no"),u.a.createElement(T["a"].Item,{label:"is base model"},r.isBase?"yes":"no"),u.a.createElement(T["a"].Item,{label:"Region(s)",span:3},p.map((function(e){return e.name})).join(", ")||""),u.a.createElement(T["a"].Item,{label:"Number of wells detected in selected region(s)"},r.n_wells||"model run not yet complete"),u.a.createElement(T["a"].Item,{label:"Status message",span:3},r.status_message||"no message"),u.a.createElement(T["a"].Item,{label:"Model description",span:3},r.description||"no description"))),u.a.createElement(_["a"],{title:u.a.createElement(Z,{title:"Model progress",anchor:"progress"}),style:{marginBottom:32},bordered:!1},u.a.createElement(P["d"].Consumer,null,(function(e){var t=e.isMobile;return u.a.createElement(R["a"],{direction:t?"vertical":"horizontal",progressDot:!0,current:y},u.a.createElement(X,{title:"Model created",description:te}),u.a.createElement(X,{title:"Ready"}),u.a.createElement(X,{title:"Running"}),u.a.createElement(X,{title:"Completed",description:ae}))}))),0===$.length?null:u.a.createElement(_["a"],{title:u.a.createElement(Z,{title:"Run results",anchor:"results"}),bodyStyle:{paddingTop:10},style:{marginBottom:32},bordered:!1,extra:u.a.createElement(S["a"],{type:"link",disabled:!r.complete,onClick:function(){m["b"].push({pathname:"/charts",query:{id:r.id}})}},"View combined model results")},u.a.createElement(x["a"],{tabPosition:"top",centered:!0},u.a.createElement(x["a"].TabPane,{tab:"Line Plot",key:"LP"},u.a.createElement(D,{percentiles:$,data:H,reductionYear:r.reduction_year})),u.a.createElement(x["a"].TabPane,{tab:"Area Plot",key:"AP"},u.a.createElement(J,{percentiles:$,data:H,reductionYear:r.reduction_year})))),u.a.createElement(_["a"],{title:u.a.createElement(Z,{title:"Crop details",anchor:"crop-details"}),bordered:!1,style:{marginBottom:32}},u.a.createElement(Y,{data:k,loading:q})),u.a.createElement(_["a"],{title:u.a.createElement(Z,{title:"Region map",anchor:"region-map"}),bordered:!1},p?u.a.createElement(A,{data:p.map((function(e){return e.geometry}))}):null)))},ee=$,te=function(e){var t=Object(d["k"])(),a=e.user,n=a.token,b=a.user_id,h=t.query,E=void 0===h?{}:h,y=t.hash,g=E.id,v=void 0===g?null:g,w=Object(s["useState"])({}),O=Object(l["a"])(w,2),k=O[0],x=O[1],_=function(e){Object(c["a"])(r.a.mark((function t(){var a;return r.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,j(v,Object(i["a"])(Object(i["a"])({},e),{},{public:!k.public}),n);case 2:a=t.sent,"string"===typeof a&&a.startsWith("ERROR")?o["a"].error({message:e.public?"un-publish model failed":"publish model failed",description:a.substr(5)}):(x(a),o["a"].success({message:"request succeeded",description:e.public?"un-published model":"published model"}));case 4:case"end":return t.stop()}}),t)})))()};return Object(s["useEffect"])((function(){if(null===v){o["a"].warn({message:"Please choose a model to view details",description:"No model specified",duration:8});var e=setTimeout((function(){m["b"].push({pathname:"/model/overview"})}),5e3);return function(){return clearTimeout(e)}}Object(c["a"])(r.a.mark((function e(){var t;return r.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,f({id:v},n);case 2:if(t=e.sent,"string"!==typeof t||!t.startsWith("ERROR")){e.next=8;break}return x({error:t}),e.abrupt("return",!0);case 8:return x(t),e.abrupt("return",!1);case 10:case"end":return e.stop()}}),e)})))()}),[v]),v?k.error?u.a.createElement(p["default"],{subTitle:"Model id with ".concat(v," not found"),title:"The model you look for cannot be found",redirection:"/model/overview",buttonText:"Select model"}):u.a.createElement(ee,{id:v,token:n,hash:y,info:k,publish:_,userId:b}):u.a.createElement(p["default"],{subTitle:"This page will be redirected in 5 seconds",title:"No model specified",redirection:"/model/overview",buttonText:"Select model"})};t["default"]=Object(m["a"])((function(e){var t=e.user;return{user:t.currentUser}}))(te)},"6K1h":function(e,t,a){},pssB:function(e,t,a){"use strict";a.r(t);a("J+/v");var n=a("MoRW"),r=(a("+L6B"),a("2/Rp")),o=a("q1tI"),i=a.n(o),c=a("9kvl"),l=function(e){var t=e.redirection,a=void 0===t?"/":t,o=e.title,l=void 0===o?"404":o,s=e.subTitle,u=void 0===s?"Sorry, the page you visited does not exist.":s,d=e.buttonText,m=void 0===d?"Back Home":d;return i.a.createElement(n["a"],{status:"404",title:l,subTitle:u,extra:i.a.createElement(r["a"],{type:"primary",onClick:function(){return c["b"].push(a)}},m)})};t["default"]=l},xVbb:function(e,t,a){e.exports={main:"main___1mp0O",headerList:"headerList___LGb6i",stepDescription:"stepDescription___3TRUQ",pageHeader:"pageHeader___2wVyh",moreInfo:"moreInfo___1IqgK"}}}]);