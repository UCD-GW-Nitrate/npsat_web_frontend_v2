(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10,7],{"+B3J":function(e,t,n){"use strict";n.r(t);n("/xke");var a=n("TeRw"),r=n("q1tI"),o=n.n(r),c=n("WHYC"),i=n("9kvl"),l=n("pssB"),s=(n("+L6B"),n("2/Rp")),u=(n("IzEo"),n("bx4M")),m=(n("cIOH"),n("jhiw"),n("TSYQ")),p=n.n(m),d=n("Zm9Q"),f=n("ACnJ"),b=n("uaoM"),y=n("H84U");function v(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){return void 0!==e&&null!==e}var E=function(e){var t,n=e.itemPrefixCls,a=e.component,o=e.span,c=e.className,i=e.style,l=e.bordered,s=e.label,u=e.content,m=e.colon,d=a;return l?r["createElement"](d,{className:p()((t={},v(t,"".concat(n,"-item-label"),h(s)),v(t,"".concat(n,"-item-content"),h(u)),t),c),style:i,colSpan:o},h(s)?s:u):r["createElement"](d,{className:p()("".concat(n,"-item"),c),style:i,colSpan:o},s&&r["createElement"]("span",{className:p()("".concat(n,"-item-label"),v({},"".concat(n,"-item-no-colon"),!m))},s),u&&r["createElement"]("span",{className:p()("".concat(n,"-item-content"))},u))},w=E;function g(e,t,n){var a=t.colon,o=t.prefixCls,c=t.bordered,i=n.component,l=n.type,s=n.showLabel,u=n.showContent;return e.map((function(e,t){var n=e.props,m=n.label,p=n.children,d=n.prefixCls,f=void 0===d?o:d,b=n.className,y=n.style,v=n.span,h=void 0===v?1:v,E=e.key;return"string"===typeof i?r["createElement"](w,{key:"".concat(l,"-").concat(E||t),className:b,style:y,span:h,colon:a,component:i,itemPrefixCls:f,bordered:c,label:s?m:null,content:u?p:null}):[r["createElement"](w,{key:"label-".concat(E||t),className:b,style:y,span:1,colon:a,component:i[0],itemPrefixCls:f,bordered:c,label:m}),r["createElement"](w,{key:"content-".concat(E||t),className:b,style:y,span:2*h-1,component:i[1],itemPrefixCls:f,bordered:c,content:p})]}))}var x=function(e){var t=e.prefixCls,n=e.vertical,a=e.row,o=e.index,c=e.bordered;return n?r["createElement"](r["Fragment"],null,r["createElement"]("tr",{key:"label-".concat(o),className:"".concat(t,"-row")},g(a,e,{component:"th",type:"label",showLabel:!0})),r["createElement"]("tr",{key:"content-".concat(o),className:"".concat(t,"-row")},g(a,e,{component:"td",type:"content",showContent:!0}))):r["createElement"]("tr",{key:o,className:"".concat(t,"-row")},g(a,e,{component:c?["th","td"]:"td",type:"item",showLabel:!0,showContent:!0}))},j=x,O=function(e){var t=e.children;return t},k=O,S=n("0n0R");function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function C(e,t){return M(e)||D(e,t)||N(e,t)||I()}function I(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function N(e,t){if(e){if("string"===typeof e)return L(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L(e,t):void 0}}function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function D(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],a=!0,r=!1,o=void 0;try{for(var c,i=e[Symbol.iterator]();!(a=(c=i.next()).done);a=!0)if(n.push(c.value),t&&n.length===t)break}catch(l){r=!0,o=l}finally{try{a||null==i["return"]||i["return"]()}finally{if(r)throw o}}return n}}function M(e){if(Array.isArray(e))return e}function T(e){return T="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T(e)}var P={xxl:3,xl:3,lg:3,md:3,sm:2,xs:1};function R(e,t){if("number"===typeof e)return e;if("object"===T(e))for(var n=0;n<f["b"].length;n++){var a=f["b"][n];if(t[a]&&void 0!==e[a])return e[a]||P[a]}return 3}function B(e,t,n){var a=e;return(void 0===t||t>n)&&(a=Object(S["a"])(e,{span:n}),Object(b["a"])(void 0===t,"Descriptions","Sum of column `span` in a line not match `column` of Descriptions.")),a}function A(e,t){var n=Object(d["a"])(e).filter((function(e){return e})),a=[],r=[],o=t;return n.forEach((function(e,c){var i,l=null===(i=e.props)||void 0===i?void 0:i.span,s=l||1;if(c===n.length-1)return r.push(B(e,l,o)),void a.push(r);s<o?(o-=s,r.push(e)):(r.push(B(e,s,o)),a.push(r),o=t,r=[])})),a}function H(e){var t,n=e.prefixCls,a=e.title,o=e.column,c=void 0===o?P:o,i=e.colon,l=void 0===i||i,s=e.bordered,u=e.layout,m=e.children,d=e.className,b=e.style,v=e.size,h=r["useContext"](y["b"]),E=h.getPrefixCls,w=h.direction,g=E("descriptions",n),x=r["useState"]({}),O=C(x,2),k=O[0],S=O[1],I=R(c,k);r["useEffect"]((function(){var e=f["a"].subscribe((function(e){"object"===T(c)&&S(e)}));return function(){f["a"].unsubscribe(e)}}),[]);var N=A(m,I);return r["createElement"]("div",{className:p()(g,d,(t={},_(t,"".concat(g,"-").concat(v),v&&"default"!==v),_(t,"".concat(g,"-bordered"),!!s),_(t,"".concat(g,"-rtl"),"rtl"===w),t)),style:b},a&&r["createElement"]("div",{className:"".concat(g,"-title")},a),r["createElement"]("div",{className:"".concat(g,"-view")},r["createElement"]("table",null,r["createElement"]("tbody",null,N.map((function(e,t){return r["createElement"](j,{key:t,index:t,colon:l,prefixCls:g,vertical:"vertical"===u,bordered:s,row:e})}))))))}H.Item=k;var F=H,J=n("k1fw"),V=n("WmNS"),q=n.n(V),z=n("9og8"),K=n("tJVT"),U=(n("FJo9"),n("L41K")),G=n("Hx5s"),Q=n("r1Ps"),W=n("fX4H"),Y=n("qnQ4"),X=(n("bMVF"),n("6K1h"),function(e){var t=e.data;return o.a.createElement(Q["a"],{center:[38.5816,-121.4944],zoom:6},o.a.createElement(W["a"],{key:t.length,data:t,onEachFeature:function(e,t){t.bindTooltip(e.properties.name)}}),o.a.createElement(Y["a"],{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}))}),Z=X,$=(n("g9YV"),n("wCAj")),ee=n("oBTY"),te=function(e){return o.a.createElement($["a"],{dataSource:Object(ee["a"])(e.data),loading:e.loading,columns:[{title:"Crops",dataIndex:"name",key:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Loading percentage",dataIndex:"proportion",key:"proportion",render:function(e){return"".concat(Math.round(100*parseFloat(e)),"%")},sorter:function(e,t){return parseFloat(e.proportion)-parseFloat(t.proportion)}}],rowKey:function(e){return e.crop},pagination:!1})},ne=te,ae=n("t3Un");function re(e,t){return oe.apply(this,arguments)}function oe(){return oe=Object(z["a"])(q.a.mark((function e(t,n){return q.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(ae["a"])("/api/model_run/".concat(t.id,"/"),{method:"GET",headers:{Authorization:"Token ".concat(n)},data:{id:t.id}}));case 1:case"end":return e.stop()}}),e)}))),oe.apply(this,arguments)}function ce(e){return ie.apply(this,arguments)}function ie(){return ie=Object(z["a"])(q.a.mark((function e(t){return q.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(ae["a"])("/api/region/".concat(t.id,"/"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),ie.apply(this,arguments)}function le(e){return se.apply(this,arguments)}function se(){return se=Object(z["a"])(q.a.mark((function e(t){return q.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(ae["a"])("/api/crops/".concat(t.id,"/"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),se.apply(this,arguments)}var ue=n("xVbb"),me=n.n(ue),pe=U["a"].Step,de=function(e){var t=e.id,n=e.token,a=Object(r["useState"])({}),c=Object(K["a"])(a,2),l=c[0],m=c[1],d=Object(r["useState"])([]),f=Object(K["a"])(d,2),b=f[0],y=f[1],v=Object(r["useState"])(0),h=Object(K["a"])(v,2),E=h[0],w=h[1],g=Object(r["useState"])([]),x=Object(K["a"])(g,2),j=x[0],O=x[1],k=Object(r["useState"])(!0),S=Object(K["a"])(k,2),_=S[0],C=S[1];Object(r["useEffect"])((function(){Object(z["a"])(q.a.mark((function e(){var a;return q.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,re({id:t},n);case 2:a=e.sent,m(a),a.complete?w(3):a.running?w(2):a.ready&&w(1);case 5:case"end":return e.stop()}}),e)})))()}),[]),Object(r["useEffect"])((function(){l.regions&&Promise.all(l.regions.map((function(e){return ce({id:e.id})}))).then((function(e){y(e)})),l.modifications&&Promise.all(l.modifications.map((function(e){return le({id:e.crop})}))).then((function(e){var t=[];e.forEach((function(e,n){var a=e.name;t.push(Object(J["a"])(Object(J["a"])({},l.modifications[n]),{},{name:a}))})),O(t),C(!1)}))}),[l]);var I=o.a.createElement("div",{className:p()(me.a.textSecondary,me.a.stepDescription)},l.date_submitted?new Date(l.date_submitted).toLocaleString():""),N=l.date_completed?o.a.createElement("div",{className:p()(me.a.textSecondary,me.a.stepDescription)},new Date(l.date_completed).toLocaleString()):null;return o.a.createElement(G["b"],null,o.a.createElement("div",{className:me.a.main},o.a.createElement(u["a"],{title:"Model info",bordered:!1,style:{marginBottom:32}},o.a.createElement(F,{bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},o.a.createElement(F.Item,{label:"Model name"},l.name),o.a.createElement(F.Item,{label:"Date created"},l.date_submitted?new Date(l.date_submitted).toLocaleString():""),o.a.createElement(F.Item,{label:"Date completed"},l.date_completed?new Date(l.date_completed).toLocaleString():"not yet completed"),o.a.createElement(F.Item,{label:"Number of years to predict"},l.n_years),o.a.createElement(F.Item,{label:"Reduction year"},l.reduction_year),o.a.createElement(F.Item,{label:"Water content"},"".concat(100*l.water_content,"%")),o.a.createElement(F.Item,{label:"Scenario"},l.scenario&&l.scenario.name||""),o.a.createElement(F.Item,{label:"Region(s)",span:3},b.map((function(e){return e.name})).join(", ")||""),o.a.createElement(F.Item,{label:"Status message",span:3},l.status_message||"no message"),o.a.createElement(F.Item,{label:"Model description",span:3},l.description||"no description"))),o.a.createElement(u["a"],{title:"Region Map",style:{marginBottom:32},bordered:!1},b?o.a.createElement(Z,{data:b.map((function(e){return e.geometry}))}):null),o.a.createElement(u["a"],{title:"Model progress",style:{marginBottom:32},bordered:!1,extra:o.a.createElement(s["a"],{type:"link",disabled:!l.complete,onClick:function(){i["b"].push({pathname:"/charts",query:{id:l.id}})}},"View results")},o.a.createElement(G["d"].Consumer,null,(function(e){var t=e.isMobile;return o.a.createElement(U["a"],{direction:t?"vertical":"horizontal",progressDot:!0,current:E},o.a.createElement(pe,{title:"Model created",description:I}),o.a.createElement(pe,{title:"Ready"}),o.a.createElement(pe,{title:"Running"}),o.a.createElement(pe,{title:"Completed",description:N}))}))),o.a.createElement(u["a"],{title:"Crop details",bordered:!1},o.a.createElement(ne,{data:j,loading:_}))))},fe=de,be=function(e){var t=Object(c["k"])(),n=e.token,s=t.query.id,u=void 0===s?null:s;return Object(r["useEffect"])((function(){null===u&&(a["a"].warn({message:"Please choose a model to view details",description:"No model specified"}),i["b"].push({pathname:"/model/overview"}))}),[u]),u?o.a.createElement(fe,{id:u,token:n}):o.a.createElement(l["default"],null)};t["default"]=Object(i["a"])((function(e){var t=e.user;return{token:t.currentUser.token}}))(be)},"6K1h":function(e,t,n){},jhiw:function(e,t,n){},pssB:function(e,t,n){"use strict";n.r(t);n("J+/v");var a=n("MoRW"),r=(n("+L6B"),n("2/Rp")),o=n("q1tI"),c=n.n(o),i=n("9kvl"),l=function(){return c.a.createElement(a["a"],{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist.",extra:c.a.createElement(r["a"],{type:"primary",onClick:function(){return i["b"].push("/")}},"Back Home")})};t["default"]=l},xVbb:function(e,t,n){e.exports={main:"main___1mp0O",headerList:"headerList___LGb6i",stepDescription:"stepDescription___3TRUQ",pageHeader:"pageHeader___2wVyh",moreInfo:"moreInfo___1IqgK"}}}]);