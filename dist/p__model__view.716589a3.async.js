(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10,7],{"+B3J":function(e,t,a){"use strict";a.r(t);a("/xke");var n=a("TeRw"),r=a("q1tI"),l=a.n(r),c=a("WHYC"),o=a("9kvl"),i=a("pssB"),u=(a("Znn+"),a("ZTPi")),s=(a("+L6B"),a("2/Rp")),m=(a("IzEo"),a("bx4M")),p=(a("bP8k"),a("gFTJ")),d=a("k1fw"),b=a("WmNS"),h=a.n(b),f=a("9og8"),E=a("tJVT"),y=(a("FJo9"),a("L41K")),g=a("Hx5s"),v=a("TSYQ"),_=a.n(v),O=(a("/zsF"),a("PArb")),j=(a("OaEy"),a("2fM7")),w=a("oBTY"),k=a("yP6+"),S=a("+n12"),x=a("Cad0"),P=a.n(x),C=function(e){var t=e.percentiles,a=e.data,n=e.reductionYear,c=Object(r["useState"])([]),o=Object(E["a"])(c,2),i=o[0],u=o[1];return l.a.createElement("div",{className:P.a.linePlot},l.a.createElement("div",{className:P.a.linePlotSelect},l.a.createElement(j["a"],{mode:"multiple",placeholder:"Select percentile(s) to show in the plot",style:{width:"100%"},onChange:function(e){return u(Object(w["a"])(e))},value:i,showArrow:!0},t.map((function(e){return l.a.createElement(j["a"].Option,{value:e,key:e},"".concat(Object(S["c"])(e)," percentile"))}))),l.a.createElement("div",{className:P.a.utilityButtons},l.a.createElement(s["a"],{type:"primary",style:{marginRight:"10px"},onClick:function(){return u([5,50,95])}},"Select 5th, 50th, 95th"),l.a.createElement(s["a"],{onClick:function(){return u([10,50,90])}},"Select 10th, 50th, 90th"),l.a.createElement(O["a"],{type:"vertical"}),l.a.createElement(s["a"],{type:"primary",style:{marginRight:"10px"},onClick:function(){return u(Object(w["a"])(t))}},"Select all"),l.a.createElement(s["a"],{onClick:function(){return u([])}},"Deselect all")),l.a.createElement(O["a"],null)),l.a.createElement(k["Chart"],{padding:[10,20,50,60],autoFit:!0,height:500,data:0===Object.keys(a).length?[]:i.map((function(e){return a[e]})).flat(1),scale:{value:{min:0,alias:"Amount of Nitrogen"},nice:!0,year:{tickCount:10}},placeholder:l.a.createElement("div",{className:P.a.noDateEntry},"Select from above percentile list"),defaultInteractions:["tooltip","element-highlight","legend-highlight"],pure:!0},l.a.createElement(k["Legend"],{position:"top"}),l.a.createElement(k["Slider"],null),l.a.createElement(k["Line"],{position:"year*value",color:"percentile"}),l.a.createElement(k["Tooltip"],{showCrosshairs:!0,shared:!0}),l.a.createElement(k["Axis"],{name:"value",title:!0}),l.a.createElement(k["Axis"],{name:"year"}),n?l.a.createElement(k["Annotation"].Line,{start:[n,"min"],end:[n,"max"],text:{position:"90%",content:"reduction year",style:{fill:"red"},autoRotate:!1}}):null))},I=C,D=a("r1Ps"),T=a("fX4H"),L=a("qnQ4"),N=(a("bMVF"),a("6K1h"),function(e){var t=e.data;return l.a.createElement(D["a"],{center:[38.5816,-121.4944],zoom:6},l.a.createElement(T["a"],{key:t.length,data:t,onEachFeature:function(e,t){t.bindTooltip(e.properties.name)}}),l.a.createElement(L["a"],{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}))}),A=N,B=(a("g9YV"),a("wCAj")),M=function(e){return l.a.createElement(B["a"],{dataSource:Object(w["a"])(e.data),loading:e.loading,columns:[{title:"Crops",dataIndex:"name",key:"name",sorter:function(e,t){return e.name.localeCompare(t.name)}},{title:"Loading percentage",dataIndex:"proportion",key:"proportion",render:function(e){return"".concat(Math.round(100*parseFloat(e)),"%")},sorter:function(e,t){return parseFloat(e.proportion)-parseFloat(t.proportion)}}],rowKey:function(e){return e.crop},pagination:!1})},R=M,F=a("t3Un");function Y(e,t){return z.apply(this,arguments)}function z(){return z=Object(f["a"])(h.a.mark((function e(t,a){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(F["a"])("/api/model_run/".concat(t.id,"/"),{method:"GET",headers:{Authorization:"Token ".concat(a)},data:{id:t.id}}));case 1:case"end":return e.stop()}}),e)}))),z.apply(this,arguments)}function q(e){return H.apply(this,arguments)}function H(){return H=Object(f["a"])(h.a.mark((function e(t){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(F["a"])("/api/region/".concat(t.id,"/"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),H.apply(this,arguments)}function J(e){return V.apply(this,arguments)}function V(){return V=Object(f["a"])(h.a.mark((function e(t){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(F["a"])("/api/crops/".concat(t.id,"/"),{method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),V.apply(this,arguments)}function G(e,t){return K.apply(this,arguments)}function K(){return K=Object(f["a"])(h.a.mark((function e(t,a){return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(F["a"])("/api/model_results/".concat(t,"/"),{headers:{Authorization:"Token ".concat(a)},method:"GET"}));case 1:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}var W=a("xVbb"),Q=a.n(W),U=(a("sniF"),a("hmE6")),Z=a.n(U),X=function(e){var t=e.percentiles,a=e.data,n=e.reductionYear,c=Object(r["useState"])(75),o=Object(E["a"])(c,2),i=o[0],u=o[1],s=Object(r["useState"])(25),m=Object(E["a"])(s,2),p=m[0],d=m[1];return l.a.createElement("div",{className:Z.a.linePlot},l.a.createElement("div",{className:Z.a.linePlotSelect},l.a.createElement(j["a"],{placeholder:"Select percentile upper bound",onChange:u,value:i},t.map((function(e){return l.a.createElement(j["a"].Option,{value:e,key:e},"".concat(Object(S["c"])(e)," percentile"))}))),l.a.createElement(j["a"],{placeholder:"Select percentile lower bound",onChange:d,value:p},t.map((function(e){return l.a.createElement(j["a"].Option,{value:e,key:e},"".concat(Object(S["c"])(e)," percentile"))}))),l.a.createElement(O["a"],null)),l.a.createElement(k["Chart"],{padding:[10,20,50,60],autoFit:!0,height:500,data:0===Object.keys(a).length||0===i||0===p?[]:a[i].map((function(e,t){return{year:e.year,value:[a[p][t].value,e.value]}})),scale:{value:{min:0,alias:"Amount of Nitrogen"},nice:!0,year:{tickCount:10}},placeholder:l.a.createElement("div",{className:Z.a.noDateEntry},"Select from above percentile list"),defaultInteractions:["tooltip","element-highlight","legend-highlight"],pure:!0},l.a.createElement(k["Legend"],{position:"top"}),l.a.createElement(k["Slider"],null),l.a.createElement(k["Area"],{position:"year*value",color:"percentile",style:{fill:"#1890ff"}}),l.a.createElement(k["Tooltip"],{showCrosshairs:!0,shared:!0}),l.a.createElement(k["Axis"],{name:"value",title:!0}),l.a.createElement(k["Axis"],{name:"year"}),n?l.a.createElement(k["Annotation"].Line,{start:[n,"min"],end:[n,"max"],text:{position:"90%",content:"reduction year",style:{fill:"red"},autoRotate:!1}}):null))},$=X,ee=y["a"].Step,te=function(e){var t=e.id,a=e.token,n=Object(r["useState"])({}),c=Object(E["a"])(n,2),i=c[0],b=c[1],v=Object(r["useState"])([]),O=Object(E["a"])(v,2),j=O[0],w=O[1],k=Object(r["useState"])(0),x=Object(E["a"])(k,2),P=x[0],C=x[1],D=Object(r["useState"])([]),T=Object(E["a"])(D,2),L=T[0],N=T[1],B=Object(r["useState"])(!0),M=Object(E["a"])(B,2),F=M[0],z=M[1],H=Object(r["useState"])({}),V=Object(E["a"])(H,2),K=V[0],W=V[1],U=Object(r["useState"])([]),Z=Object(E["a"])(U,2),X=Z[0],te=Z[1];Object(r["useEffect"])((function(){Object(f["a"])(h.a.mark((function e(){var n;return h.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Y({id:t},a);case 2:n=e.sent,b(n),n.complete?C(3):n.running?C(2):n.ready&&C(1);case 5:case"end":return e.stop()}}),e)})))()}),[]),Object(r["useEffect"])((function(){i.regions&&Promise.all(i.regions.map((function(e){return q({id:e.id})}))).then((function(e){w(e)})),i.modifications&&Promise.all(i.modifications.map((function(e){return J({id:e.crop})}))).then((function(e){var t=[];e.forEach((function(e,a){var n=e.name;t.push(Object(d["a"])(Object(d["a"])({},i.modifications[a]),{},{name:n}))})),N(t),z(!1)})),i.results&&Promise.all(i.results.map((function(e){return G(e.id,a)}))).then((function(e){var t={};e.forEach((function(e){t[e.percentile]=e.values.map((function(t,a){return{year:1945+a,value:t,percentile:"".concat(Object(S["c"])(e.percentile)," percentile")}}))})),te(e.map((function(e){return e.percentile}))),W(t)}))}),[i]);var ae=l.a.createElement("div",{className:_()(Q.a.textSecondary,Q.a.stepDescription)},i.date_submitted?new Date(i.date_submitted).toLocaleString():""),ne=i.date_completed?l.a.createElement("div",{className:_()(Q.a.textSecondary,Q.a.stepDescription)},new Date(i.date_completed).toLocaleString()):null;return l.a.createElement(g["b"],null,l.a.createElement("div",{className:Q.a.main},l.a.createElement(m["a"],{title:"Model info",bordered:!1,style:{marginBottom:32}},l.a.createElement(p["a"],{bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1}},l.a.createElement(p["a"].Item,{label:"Model name"},i.name),l.a.createElement(p["a"].Item,{label:"Date created"},i.date_submitted?new Date(i.date_submitted).toLocaleString():""),l.a.createElement(p["a"].Item,{label:"Date completed"},i.date_completed?new Date(i.date_completed).toLocaleString():"not yet completed"),l.a.createElement(p["a"].Item,{label:"Number of years to predict"},i.n_years),l.a.createElement(p["a"].Item,{label:"Reduction year"},i.reduction_year),l.a.createElement(p["a"].Item,{label:"Water content"},"".concat(100*i.water_content,"%")),l.a.createElement(p["a"].Item,{label:"Scenario"},i.scenario&&i.scenario.name||""),l.a.createElement(p["a"].Item,{label:"Region(s)",span:3},j.map((function(e){return e.name})).join(", ")||""),l.a.createElement(p["a"].Item,{label:"Number of wells detected in selected region(s)"},i.n_wells||"model run not yet finishes"),l.a.createElement(p["a"].Item,{label:"Status message",span:3},i.status_message||"no message"),l.a.createElement(p["a"].Item,{label:"Model description",span:3},i.description||"no description"))),l.a.createElement(m["a"],{title:"Model progress",style:{marginBottom:32},bordered:!1,extra:l.a.createElement(s["a"],{type:"link",disabled:!i.complete,onClick:function(){o["b"].push({pathname:"/charts",query:{id:i.id}})}},"View combined model results")},l.a.createElement(g["d"].Consumer,null,(function(e){var t=e.isMobile;return l.a.createElement(y["a"],{direction:t?"vertical":"horizontal",progressDot:!0,current:P},l.a.createElement(ee,{title:"Model created",description:ae}),l.a.createElement(ee,{title:"Ready"}),l.a.createElement(ee,{title:"Running"}),l.a.createElement(ee,{title:"Completed",description:ne}))}))),0===X.length?null:l.a.createElement(m["a"],{title:"Run result",style:{marginBottom:32},bordered:!1},l.a.createElement(u["a"],{tabPosition:"top",centered:!0},l.a.createElement(u["a"].TabPane,{tab:"Line Plot",key:"LP"},l.a.createElement(I,{percentiles:X,data:K,reductionYear:i.reduction_year})),l.a.createElement(u["a"].TabPane,{tab:"Area Plot",key:"AP"},l.a.createElement($,{percentiles:X,data:K,reductionYear:i.reduction_year})))),l.a.createElement(m["a"],{title:"Crop details",bordered:!1,style:{marginBottom:32}},l.a.createElement(R,{data:L,loading:F})),l.a.createElement(m["a"],{title:"Region Map",bordered:!1},j?l.a.createElement(A,{data:j.map((function(e){return e.geometry}))}):null)))},ae=te,ne=function(e){var t=Object(c["k"])(),a=e.token,u=t.query.id,s=void 0===u?null:u;return Object(r["useEffect"])((function(){null===s&&(n["a"].warn({message:"Please choose a model to view details",description:"No model specified"}),o["b"].push({pathname:"/model/overview"}))}),[s]),s?l.a.createElement(ae,{id:s,token:a}):l.a.createElement(i["default"],null)};t["default"]=Object(o["a"])((function(e){var t=e.user;return{token:t.currentUser.token}}))(ne)},"6K1h":function(e,t,a){},Cad0:function(e,t,a){e.exports={linePlot:"linePlot___3eDXh",linePlotSelect:"linePlotSelect___3sMMY",utilityButtons:"utilityButtons___2Zzoj",noDateEntry:"noDateEntry___EOibc"}},hmE6:function(e,t,a){e.exports={linePlot:"linePlot___1mMWu",linePlotSelect:"linePlotSelect___N_qs6",utilityButtons:"utilityButtons___20uyg",noDateEntry:"noDateEntry___HdY94"}},pssB:function(e,t,a){"use strict";a.r(t);a("J+/v");var n=a("MoRW"),r=(a("+L6B"),a("2/Rp")),l=a("q1tI"),c=a.n(l),o=a("9kvl"),i=function(){return c.a.createElement(n["a"],{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist.",extra:c.a.createElement(r["a"],{type:"primary",onClick:function(){return o["b"].push("/")}},"Back Home")})};t["default"]=i},xVbb:function(e,t,a){e.exports={main:"main___1mp0O",headerList:"headerList___LGb6i",stepDescription:"stepDescription___3TRUQ",pageHeader:"pageHeader___2wVyh",moreInfo:"moreInfo___1IqgK"}}}]);